function updateScrollbar(){$messages.mCustomScrollbar("update").mCustomScrollbar("scrollTo","bottom",{scrollInertia:10,timeout:0})}function setDate(){d=new Date,m!=d.getMinutes()&&(m=d.getMinutes(),$('<div class="timestamp">'+d.getHours()+":"+m+"</div>").appendTo($(".message:last")))}function output(t){UserDictation.stop(),msg=t,insertMessage(!0)}function insertMessage(t){return 0==t&&(msg=$(".message-input").val()),""==$.trim(msg)?!1:($('<div class="message message-personal">'+msg+"</div>").appendTo($(".mCSB_container")).addClass("new"),setDate(),$(".message-input").val(null),updateScrollbar(),interact(msg),void setTimeout(function(){},1e3+20*Math.random()*100))}function interact(t){$('<div class="message loading new"><figure class="avatar"><img src="/static/res/botim.jpg" /></figure><span></span></div>').appendTo($(".mCSB_container")),$.post("/message",{msg:t}).done(function(t){$(".message.loading").remove(),$('<div class="message new"><figure class="avatar"><img src="/static/res/botim.jpg" /></figure>'+t.text+"</div>").appendTo($(".mCSB_container")).addClass("new"),setDate(),updateScrollbar(),artyom.say(t.text),UserDictation.start()}).fail(function(){alert("error calling function")})}var UserDictation=artyom.newDictation({continuous:!0,onResult:function(t){output(t),console.log(t)},onStart:function(){console.log("starting")},onEnd:function(){console.log("Dictation stopped by the user")}});artyom.initialize({lang:"en-US",continuous:!1,listen:!1,soundex:!0,debug:!0,speed:1}),UserDictation.start(),artyom.detectErrors();var $messages=$(".messages-content"),d,h,m,text,msg,i=0;$(window).load(function(){$messages.mCustomScrollbar(),setTimeout(function(){},100)}),$(".message-submit").click(function(){insertMessage(!1)}),$(window).on("keydown",function(t){return 13==t.which?(insertMessage(!1),!1):void 0});